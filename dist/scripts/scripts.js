"use strict";angular.module("candidatesCologneElectionApp",["ngCookies","ngResource","ngSanitize","ngRoute"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("candidatesCologneElectionApp").controller("MainCtrl",["$scope","$http",function(a,b){function c(a){var b=a.toLowerCase().replace(/[^a-z]/g,"");return b}var d=document.getElementById("map");d.style.height=""+.8*window.innerHeight+"px";var e=new OpenLayers.Map("map");e.addLayer(new OpenLayers.Layer.OSM);var f=new OpenLayers.Projection("EPSG:4326"),g=new OpenLayers.Projection("EPSG:900913"),h=new OpenLayers.LonLat(6.9599115,50.9406645).transform(f,g);e.setCenter(h,11.5);var i=new OpenLayers.Layer.Markers("Markers");e.addLayer(i);var j={spd:"ff0000",cdu:"000000",fdp:"fed530",grne:"7ab857",dielinke:"dc0000",afd:"009ee0",fwk:"004191",deinefreunde:"00aff3",diepartei:"b5152b",piraten:"fa8810",einzelbewerber:"ffffff",einheit:"ffae00",big:"061f71",npd:"572d00",prokln:"875d02",ld:"ca6010"};a.parties=[];var k={};a.toggleSelection=function(a){if(a.selected=!a.selected,a.selected)for(var b in a.markers){var c=a.markers[b];i.addMarker(c)}else for(var b in a.markers){var c=a.markers[b];i.removeMarker(c)}},a.selectionAlpha=function(a){return a.selected?1:.5};var l=[];b.get("data.json").success(function(b){for(var d in b){var e=b[d],m=e.partei_kurzname;k[m]||(k[m]=0),k[m]=k[m]+1;var n=c(m);h=new OpenLayers.LonLat(parseFloat(e.GeocodeLng),parseFloat(e.GeocodeLat)),h=h.transform(f,g);var o=new OpenLayers.Size(28,43),p=new OpenLayers.Icon("images/"+n+".png",o),q=new OpenLayers.Marker(h,p);i.addMarker(q),l[m]||(l[m]=[]),l[m].push(q)}for(var m in k){var n=c(m);a.parties.push({name:m,color:j[n],count:k[m],selected:!0,markers:l[m]})}})}]);